#!/bin/bash

calcoeff="63.96,-108.59,-0.00,74.02,42.41,-29.26,37.30,-22.29,107.44,145.24,-25.42,-75.08,119.13,127.51,52.69,48.70,56.33,15.79,-45.72,23.92,-64.50,-57.29,-41.63,29.21,117.46,119.16,73.84,81.31,-74.50,-93.91,58.49,84.43,50.74,-68.68,-64.90,75.31,-72.41,-76.84,101.06,76.81,-82.32,-82.53,-70.44,82.93,-89.09,-54.91,-49.51,-48.32,-86.48,-133.02,-86.85,48.80,-90.87,79.67,125.52,97.83,-28.56,-58.53,-82.02,-62.68,76.44,-35.62,85.53,102.09,93.00,-57.48,-91.45,-121.32,150.39,-102.74,-30.35,-98.68,-96.18,-69.30,-70.89,74.16,97.94,73.05,-55.83,-82.42,108.12,-118.29,75.66,-128.17,84.21,-79.27,-65.61,75.80,112.12,-138.14,-87.32,86.29,-94.37,-105.93,73.75,75.71,-90.09,-58.86,-90.77,-79.56,53.30,81.75,66.17,-69.60,92.21,-70.63,-93.57,-99.40,-69.42,-95.75,90.30,99.32,97.46,-106.99,62.42,106.09,-132.98,-115.43,-133.05,-114.30,-97.78,-58.43,-160.12,-137.40,35.74,-73.69,-89.49,79.37,84.73,19.87,-78.53,30.40,-60.91,-108.97,-95.22,-80.51,37.95,71.99,63.90,88.83,113.65,83.98,-70.33,87.76,-104.10,59.57,-61.36,-64.09,-68.64,50.61,-78.11,69.64,106.62,-73.61,99.76,78.41,-100.21,-96.45,48.27,-79.40,84.00,-104.73,60.69,-64.27,-87.25,-68.91,-62.25,77.68,-87.25,-63.55,88.95,-78.80,67.89,77.68,-77.40,-79.79,83.81,53.13,48.87,41.07,-60.74,-61.23,62.38,-76.67,-97.19,-22.46,86.23,-74.75,-97.21,87.52,83.75,-57.17,57.34,-80.96,71.58,114.46,-52.45,91.40,-87.80,82.62,83.51,-103.90,80.04,-101.83,90.81,-44.86,-58.85,-82.12,77.06,31.93,68.31,93.16,31.77,-34.40,-69.06,60.59,-47.24,82.19,36.48,-75.21,56.88,-66.61,-116.29,-26.82,106.77,79.42,113.10,63.93,-56.34,150.00,-64.81,-109.73,64.74,96.56,29.75,68.53,-56.40,73.21,60.74,84.26,-70.79,-34.57,60.01,-36.51,-123.92,-109.21,-103.47,-84.74,-151.13,-90.82,-77.72,-124.09,-89.08,51.08,-56.72,-116.72"
if [[ -n "$1" && "$1" != "-" ]]; then
   calcoeff="$1"
fi

outfile=20190818_24hours_50MHz_eda2_256ant_GalCal.txt 
if [[ -n "$2" && "$2" != "-" ]]; then
   outfile=$2
fi
stdout_file=${outfile%%txt}out

export PATH=~/msok/eda2/msok_scripts:$PATH
export LD_LIBRARY_PATH=~/msok/eda2/lib:$LD_LIBRARY_PATH

echo "nohup beamform_all.sh \"-C 1 -X ${calcoeff}\" ${outfile} > ${stdout_file} 2>&1 &"
nohup beamform_all.sh "-C 1 -X ${calcoeff}" ${outfile} > ${stdout_file} 2>&1 &
